!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).tus=e()}}(function(){return function e(t,o,r){function n(s,u){if(!o[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var l=o[s]={exports:{}};t[s][0].call(l.exports,function(e){var o=t[s][1][e];return n(o||e)},l,l.exports,e,t,o,r)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return["tus",e.name,e.type,e.size,e.lastModified].join("-")}},{}],2:[function(e,t,o){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(e("./upload")),n=r.default.defaultOptions,i=window,s=i.XMLHttpRequest,u=i.localStorage,a=i.Blob,f=s&&u&&a&&"function"==typeof a.prototype.slice;t.exports={Upload:r.default,isSupported:f,defaultOptions:n}},{"./upload":3}],3:[function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if(!("btoa"in window))return"";var t=[];for(var o in e)t.push(o+" "+p(unescape(encodeURIComponent(e[o]))));return t.join(",")}var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}();Object.defineProperty(o,"__esModule",{value:!0});var u=r(e("./fingerprint")),a=r(e("extend")),f=window,l=f.localStorage,p=f.btoa,d={endpoint:"",fingerprint:u.default,resume:!0,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,headers:{},chunkSize:1/0,withCredentials:!1},c=function(){function e(t,o){n(this,e),this.options=(0,a.default)(!0,{},d,o),this.file=t,this.url=null,this._xhr=null,this._fingerprint=null,this._offset=null,this._aborted=!1}return s(e,[{key:"start",value:function(){var e=this.file;if(e)if(this.options.endpoint)if(null===this.url){if(this.options.resume){this._fingerprint=this.options.fingerprint(e);var t=l.getItem(this._fingerprint);if(null!=t)return this.url=t,void this._resumeUpload()}this._createUpload()}else this._resumeUpload();else this._emitError(new Error("tus: no endpoint provided"));else this._emitError(new Error("tus: no file to upload provided"))}},{key:"abort",value:function(){null!==this._xhr&&(this._xhr.abort(),this._aborted=!0)}},{key:"_emitXhrError",value:function(e,t){t.originalRequest=e,this._emitError(t)}},{key:"_emitError",value:function(e){if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}},{key:"_emitSuccess",value:function(){"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,o){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,o)}},{key:"_setupXHR",value:function(e){e.setRequestHeader("Tus-Resumable","1.0.0");var t=this.options.headers;for(var o in t)e.setRequestHeader(o,t[o]);e.withCredentials=this.options.withCredentials}},{key:"_createUpload",value:function(){var e=this,t=new XMLHttpRequest;t.open("POST",this.options.endpoint,!0),t.onload=function(){t.status>=200&&t.status<300?(e.url=t.getResponseHeader("Location"),e.options.resume,e._offset=0,e._startUpload()):e._emitXhrError(t,new Error("tus: unexpected response while creating upload"))},t.onerror=function(){e._emitXhrError(t,new Error("tus: failed to create upload"))},this._setupXHR(t),t.setRequestHeader("Upload-Length",this.file.size);var o=i(this.options.metadata);""!==o&&t.setRequestHeader("Upload-Metadata",o),t.send(null)}},{key:"_resumeUpload",value:function(){var e=this,t=new XMLHttpRequest;t.open("HEAD",this.url,!0),t.onload=function(){if(!(t.status>=200&&t.status<300))return e.options.resume&&l.removeItem(e._fingerprint),e.url=null,void e._createUpload();var o=parseInt(t.getResponseHeader("Upload-Offset"),10);isNaN(o)?e._emitXhrError(t,new Error("tus: invalid or missing offset value")):(e._offset=o,e._startUpload())},t.onerror=function(){e._emitXhrError(t,new Error("tus: failed to resume upload"))},this._setupXHR(t),t.send(null)}},{key:"_startUpload",value:function(){var e=this,t=this._xhr=new XMLHttpRequest;t.open("PATCH",this.url,!0),t.onload=function(){if(t.status>=200&&t.status<300){var o=parseInt(t.getResponseHeader("Upload-Offset"),10);if(isNaN(o))e._emitXhrError(t,new Error("tus: invalid or missing offset value"));else{if(e._emitChunkComplete(o-e._offset,o,e.file.size),e._offset=o,o==e.file.size)return e._emitProgress(o,o),void e._emitSuccess();e._startUpload()}}else e._emitXhrError(t,new Error("tus: unexpected response while creating upload"))},t.onerror=function(){e._aborted||e._emitXhrError(t,new Error("tus: failed to upload chunk at offset "+e._offset))},"upload"in t&&(t.upload.onprogress=function(t){t.lengthComputable&&e._emitProgress(o+t.loaded,e.file.size)}),this._setupXHR(t),t.setRequestHeader("Upload-Offset",this._offset),t.setRequestHeader("Content-Type","application/offset+octet-stream");var o=this._offset,r=this._offset+this.options.chunkSize;r===1/0&&(r=this.file.size),t.send(this.file.slice(o,r))}}]),e}();c.defaultOptions=d,o.default=c},{"./fingerprint":1,extend:4}],4:[function(e,t,o){"use strict";var r=Object.prototype.hasOwnProperty,n=Object.prototype.toString,i=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},s=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var t=r.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!o)return!1;var i;for(i in e);return void 0===i||r.call(e,i)};t.exports=function e(){var t,o,r,n,u,a,f=arguments[0],l=1,p=arguments.length,d=!1;for("boolean"==typeof f?(d=f,f=arguments[1]||{},l=2):("object"!=typeof f&&"function"!=typeof f||null==f)&&(f={});l<p;++l)if(null!=(t=arguments[l]))for(o in t)r=f[o],f!==(n=t[o])&&(d&&n&&(s(n)||(u=i(n)))?(u?(u=!1,a=r&&i(r)?r:[]):a=r&&s(r)?r:{},f[o]=e(d,a,n)):void 0!==n&&(f[o]=n));return f}},{}]},{},[2])(2)});